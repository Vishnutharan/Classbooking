<div class="dashboard-container">
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">ğŸ“š</div>
      <h3>{{ stats.totalClassesBooked }}</h3>
      <p>Total Classes Booked</p>
    </div>
    <div class="stat-card">
      <div class="stat-icon">âœ…</div>
      <h3>{{ stats.completedClasses }}</h3>
      <p>Completed Classes</p>
    </div>
    <div class="stat-card">
      <div class="stat-icon">â±ï¸</div>
      <h3>{{ (stats.hoursStudied) | number:'1.1-1' }}</h3>
      <p>Hours Studied</p>
    </div>
    <div class="stat-card">
      <div class="stat-icon">â­</div>
      <h3>{{ (stats.averageRating) | number:'1.1-1' }}</h3>
      <p>Average Rating</p>
    </div>
  </div>

  <div class="actions-section">
    <button class="action-btn primary" (click)="bookClass()">ğŸ“š Book a Class</button>
    <button class="action-btn" (click)="viewExamMaterials()">ğŸ“– Exam Materials</button>
    <button class="action-btn" (click)="seePastPapers()">ğŸ“„ Past Papers</button>
  </div>

  <div class="section">
    <h2>ğŸ“… Upcoming Classes</h2>
    <div class="upcoming-list" *ngIf="upcomingClasses.length > 0; else noUpcoming">
      <div class="upcoming-card" *ngFor="let booking of upcomingClasses">
        <div class="card-header">
          <h3>{{ booking.subject }}</h3>
          <span class="status-badge confirmed">{{ booking.status }}</span>
        </div>
        <div class="card-body">
          <p><strong>Teacher:</strong> {{ booking.teacherId }}</p>
          <p><strong>Date:</strong> {{ booking.date | date:'MMM dd, yyyy' }}</p>
          <p><strong>Time:</strong> {{ booking.startTime }} - {{ booking.endTime }}</p>
          <p><strong>Type:</strong> {{ booking.classType }}</p>
          <p *ngIf="booking.notes"><strong>Notes:</strong> {{ booking.notes }}</p>
        </div>
        <div class="card-actions" style="display: flex; gap: 10px; margin-top: 15px;">
          <button class="card-btn" (click)="viewBooking(booking.id)" style="flex: 1;">View Details</button>
          <a class="card-btn join-btn" [href]="booking.meetingLink" target="_blank"
            *ngIf="booking.status === 'Confirmed' && booking.meetingLink"
            style="flex: 1; text-align: center; text-decoration: none; background: #28a745; display: flex; align-items: center; justify-content: center;">
            ğŸ¥ Join Class
          </a>
        </div>
      </div>
    </div>
    <div class="section-actions" style="margin-top: 20px; text-align: center;" *ngIf="upcomingClasses.length > 0">
      <button class="action-btn primary" (click)="bookClass()">â• Book Another Class</button>
    </div>
    <ng-template #noUpcoming>
      <div class="empty-state">
        <p>No upcoming classes found.</p>
        <button class="action-btn primary mt-2" (click)="bookClass()">Book one now!</button>
      </div>
    </ng-template>
  </div>

  <div class="section">
    <h2>ğŸ‘¨â€ğŸ« Recommended Teachers</h2>
    <div class="teachers-carousel" *ngIf="recommendedTeachers.length > 0">
      <div class="teacher-card" *ngFor="let teacher of recommendedTeachers">
        <div class="teacher-header">
          <img [src]="teacher.profilePicture || 'https://via.placeholder.com/100'" alt="{{ teacher.fullName }}"
            class="teacher-avatar">
          <div class="teacher-info">
            <h4>{{ teacher.fullName }}</h4>
            <p class="rating">â­ {{ (teacher.averageRating) | number:'1.1-1' }} ({{ teacher.totalReviews }} reviews)</p>
          </div>
        </div>
        <div class="teacher-body">
          <p><strong>Experience:</strong> {{ teacher.experienceYears }} years</p>
          <p><strong>Rate:</strong> LKR {{ teacher.hourlyRate }}/hour</p>
          <div class="subjects">
            <span class="subject-tag" *ngFor="let subject of teacher.subjects | slice:0:3">
              {{ subject.name }}
            </span>
          </div>
        </div>
        <button class="teacher-btn" (click)="viewTeacherProfile(teacher.id)">View Profile</button>
      </div>
    </div>
  </div>

  <div class="section">
    <h2>ğŸ“Š Recent Activity</h2>
    <div class="activity-feed" *ngIf="recentActivity.length > 0; else noActivity">
      <div class="activity-item" *ngFor="let activity of recentActivity">
        <div class="activity-icon">{{ activity.icon }}</div>
        <div class="activity-content">
          <p>{{ activity.message }}</p>
          <span class="activity-time">{{ activity.timestamp | date:'short' }}</span>
        </div>
      </div>
    </div>
    <ng-template #noActivity>
      <div class="empty-state">
        <p>No recent activity yet.</p>
      </div>
    </ng-template>
  </div>

  <div *ngIf="isLoading" class="loading-spinner"></div>
</div>